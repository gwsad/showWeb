import{d as b,r as d,u as C,l as a,q as V,c as A,e as T,f as o,t as r,y as _,B as h,g as D,A as N,v as l,z as e,C as k,p as q,k as z,_ as G}from"./index-411323ad.js";import{l as H}from"./project-logo-72cb1144.js";import{m as M}from"./project-more-48b6ca7f.js";import{h as R}from"./home-f9d3d4ef.js";import{u as m}from"./user-3038cb41.js";import{u as y}from"./card-2dea2ce7.js";import{s as j}from"./function-call-6e6b205c.js";import{A as E}from"./index-7bc234ff.js";import"./Dialog-112ca358.js";import"./use-route-a7422fad.js";const L=u=>(q("data-v-2ee409aa"),u=u(),z(),u),O={class:"register"},$={class:"register__head"},F=["src"],J=L(()=>o("span",null,"选择地区：",-1)),K=["src"],P={class:"register__info"},Q={class:"register__info__item"},W=["placeholder"],X={class:"register__info__item"},Y=["placeholder"],Z={class:"register__info__item"},ee=["placeholder"],oe={class:"common-btn"},se=b({__name:"registerIndex",setup(u){const p=d(!1),v=d(!0),{currentRoute:x}=C(),{query:f}=a(x),s=d({phone:"",invitationCode:"",password:""}),g=C(),c=d("中国大陆"),I=d([{name:"中国大陆"},{name:"中国台湾"},{name:"中国香港"},{name:"中国澳门"}]),S=()=>{p.value=!0,v.value=!1},w=()=>{p.value=!1,v.value=!0},U=i=>{c.value=i.name,w()};V(()=>{f.shareCode&&(s.value.invitationCode=f.shareCode)});const B=async()=>{if(!s.value.phone)return l({message:e("请输入手机号码"),duration:2e3});if(!s.value.password)return l({message:e("请输入密码"),duration:2e3});switch(c.value){case e("中国大陆"):if(s.value.phone.length!==11)return l({message:e("请输入正确的手机号码"),duration:2e3});break;case e("中国台湾"):if(s.value.phone.length!==10)return l({message:e("请输入正确的手机号码"),duration:2e3});break;case(e("香港特别行政区")||e("澳门特别行政区")):if(s.value.phone.length!==8)return l({message:e("请输入正确的手机号码"),duration:2e3});break}try{let i=await m().loginByUsername({phone:s.value.phone,password:s.value.password});k(i.data.token),await y().setCouponCat(),await m().handleGetUserInfo(),g.push({path:"/enter/home"})}catch(i){i.code===20006&&j({message:"未检测到账户，平台将会使用该号码注册账号，是否确认？"}).then(async()=>{s.value.invitationCode=String(s.value.invitationCode);let t=await R(Object.assign(s.value,{region:c.value}));t.code===200?(k(t.data.token),await y().setCouponCat(),await m().handleGetUserInfo(),g.push({path:"/enter/home"})):l({message:e(t.message),duration:2e3})})}};return(i,t)=>(A(),T("div",O,[o("div",$,[o("img",{src:a(H),alt:""},null,8,F),o("span",null,r(a(e)("欢迎来到港回收")),1)]),o("div",{class:"register__address",onClick:t[0]||(t[0]=n=>S())},[o("div",null,[J,o("span",null,r(a(e)(c.value)),1)]),o("img",{src:a(M),alt:""},null,8,K)]),o("div",P,[o("div",Q,[o("div",null,r(a(e)("手机号码：")),1),_(o("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.phone=n),type:"phone",maxlength:"11",minlength:"5",placeholder:a(e)("请输入手机号码")},null,8,W),[[h,s.value.phone]])]),o("div",X,[o("div",null,r(a(e)("邀请码：")),1),_(o("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>s.value.invitationCode=n),type:"text",placeholder:a(e)("请输入邀请码")},null,8,Y),[[h,s.value.invitationCode]])]),o("div",Z,[o("div",null,r(a(e)("密码：")),1),_(o("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>s.value.password=n),type:"text",placeholder:a(e)("请输入密码")},null,8,ee),[[h,s.value.password]])])]),D(a(E),{show:p.value,"onUpdate:show":t[4]||(t[4]=n=>p.value=n),actions:I.value,onSelect:U,title:a(e)("选择地区"),onClose:w},null,8,["show","actions","title"]),_(o("div",oe,[o("div",{onClick:B},r(a(e)("确定")),1)],512),[[N,v.value]])]))}});const _e=G(se,[["__scopeId","data-v-2ee409aa"]]);export{_e as default};
